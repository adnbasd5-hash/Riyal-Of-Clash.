<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Riyal of Clash | Ø§Ù„Ø£Ø³Ø·ÙˆØ±Ø©</title>
    <style>
        :root { --gold: #ffd700; --blue: #00d4ff; --red: #ff4d4d; --purple: #a020f0; }
        body { margin: 0; background: #000; color: white; font-family: 'Arial', sans-serif; overflow: hidden; touch-action: none; }
        
        /* ÙˆØ§Ø¬Ù‡Ø© Brawl Stars Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
        .ui-layer { position: fixed; inset: 0; pointer-events: none; z-index: 10; }
        .top-stats { display: flex; justify-content: space-between; padding: 10px; pointer-events: auto; }
        .stat-card { background: rgba(0,0,0,0.7); border: 2px solid var(--gold); border-radius: 15px; padding: 5px 15px; display: flex; align-items: center; gap: 8px; font-weight: bold; }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
        .side-bar { position: absolute; left: 10px; top: 80px; display: flex; flex-direction: column; gap: 10px; pointer-events: auto; }
        .icon-btn { width: 50px; height: 50px; background: #34495e; border: 3px solid #fff; border-radius: 12px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 24px; }
        
        /* Ø§Ù„Ø£Ù†Ø§Ù„ÙˆØ¬ ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± */
        .controls { position: absolute; bottom: 0; width: 100%; height: 250px; }
        #joystick { position: absolute; bottom: 50px; left: 50px; width: 120px; height: 120px; background: rgba(255,255,255,0.1); border-radius: 50%; border: 3px solid rgba(255,255,255,0.3); pointer-events: auto; }
        #stick { position: absolute; top: 30px; left: 30px; width: 60px; height: 60px; background: #fff; border-radius: 50%; opacity: 0.7; }
        
        .action-btns { position: absolute; bottom: 50px; right: 50px; display: flex; flex-direction: column; gap: 20px; align-items: center; pointer-events: auto; }
        .btn-main { width: 90px; height: 90px; border-radius: 50%; border: 5px solid #fff; display: flex; align-items: center; justify-content: center; font-size: 35px; cursor: pointer; box-shadow: 0 6px 0 rgba(0,0,0,0.3); }
        .attack { background: var(--red); }
        .super { background: var(--gold); width: 70px; height: 70px; font-size: 25px; border-color: var(--purple); display: none; }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
        #settings-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 100; flex-direction: column; align-items: center; justify-content: center; pointer-events: auto; }
        .modal-content { background: #2c3e50; padding: 30px; border-radius: 20px; border: 4px solid var(--gold); text-align: center; width: 80%; }
        
        canvas { display: block; }
    </style>
</head>
<body>

    <div class="ui-layer">
        <div class="top-stats">
            <div class="stat-card">ğŸ† <span>3051</span></div>
            <div class="stat-card">ğŸ’° <span id="gold">2544</span></div>
            <div class="stat-card">ğŸ’ <span id="gems">0</span></div>
        </div>

        <div class="side-bar">
            <div class="icon-btn" onclick="toggleSettings()">âš™ï¸</div>
            <div class="icon-btn">ğŸ›’</div>
            <div class="icon-btn">ğŸ‘¥</div>
        </div>

        <div class="controls">
            <div id="joystick"><div id="stick"></div></div>
            <div class="action-btns">
                <div id="super-btn" class="btn-main super">ğŸŒŸ</div>
                <div id="attack-btn" class="btn-main attack">âš”ï¸</div>
            </div>
        </div>
    </div>

    <div id="settings-modal" onclick="toggleSettings()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h2 style="color:var(--gold)">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª âš™ï¸</h2>
            <hr>
            <p>Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰: <input type="range"></p>
            <p>Ø§Ù„Ù…Ø¤Ø«Ø±Ø§Øª: <input type="range"></p>
            <button onclick="toggleSettings()" style="background:var(--red); color:white; padding:10px 20px; border:none; border-radius:10px;">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let player = { x: canvas.width/2, y: canvas.height/2, size: 28, hp: 100, maxHp: 100, gems: 0, superCharge: 0 };
        let bullets = [], enemies = [], items = [], moveX = 0, moveY = 0;

        // ØªÙˆÙ„ÙŠØ¯ Ø£Ø¹Ø¯Ø§Ø¡ ÙˆØ¬ÙˆØ§Ù‡Ø±
        function spawnStuff() {
            if(enemies.length < 3) enemies.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, hp: 100 });
            if(items.length < 5) items.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height });
        }
        setInterval(spawnStuff, 2000);

        // Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ…
        const joystick = document.getElementById('joystick');
        const stick = document.getElementById('stick');
        joystick.addEventListener('touchstart', (e) => {});
        window.addEventListener('touchmove', (e) => {
            let touch = e.touches[0];
            let rect = joystick.getBoundingClientRect();
            let dx = touch.clientX - (rect.left + 60);
            let dy = touch.clientY - (rect.top + 60);
            let dist = Math.min(Math.hypot(dx, dy), 50);
            let angle = Math.atan2(dy, dx);
            stick.style.transform = `translate(${Math.cos(angle)*dist}px, ${Math.sin(angle)*dist}px)`;
            moveX = Math.cos(angle) * (dist/50) * 5;
            moveY = Math.sin(angle) * (dist/50) * 5;
        });
        window.addEventListener('touchend', () => {
            stick.style.transform = 'translate(0,0)'; moveX = 0; moveY = 0;
        });

        // Ø§Ù„Ù‡Ø¬ÙˆÙ… Ø§Ù„Ø¹Ø§Ø¯ÙŠ ÙˆØ§Ù„Ø³ÙˆØ¨Ø±
        document.getElementById('attack-btn').addEventListener('touchstart', () => fire(false));
        document.getElementById('super-btn').addEventListener('touchstart', () => fire(true));

        function fire(isSuper) {
            let color = isSuper ? "purple" : "yellow";
            bullets.push({ x: player.x, y: player.y, vx: moveX*3 || 10, vy: moveY*3 || 0, isSuper, color });
            if(isSuper) { player.superCharge = 0; document.getElementById('super-btn').style.display = 'none'; }
        }

        function toggleSettings() {
            const m = document.getElementById('settings-modal');
            m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
        }

        function draw() {
            ctx.fillStyle = "#1e3a5f"; ctx.fillRect(0,0,canvas.width, canvas.height);
            
            player.x += moveX; player.y += moveY;

            // Ø±Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙˆØ´Ø±ÙŠØ· Ø§Ù„Ø­ÙŠØ§Ø©
            ctx.fillStyle = player.superCharge >= 100 ? "var(--purple)" : "var(--blue)";
            ctx.beginPath(); ctx.arc(player.x, player.y, player.size, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle = "red"; ctx.fillRect(player.x-20, player.y-40, 40, 5);
            ctx.fillStyle = "green"; ctx.fillRect(player.x-20, player.y-40, (player.hp/player.maxHp)*40, 5);

            // Ø±Ø³Ù… Ø§Ù„Ø¬ÙˆØ§Ù‡Ø±
            items.forEach((item, i) => {
                ctx.fillStyle = "magenta"; ctx.fillRect(item.x, item.y, 15, 15);
                if(Math.hypot(player.x-item.x, player.y-item.y) < 30) { items.splice(i,1); player.gems++; document.getElementById('gems').innerText = player.gems; }
            });

            // Ø±Ø³Ù… Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
            enemies.forEach((en, i) => {
                ctx.fillStyle = "red"; ctx.beginPath(); ctx.arc(en.x, en.y, 30, 0, Math.PI*2); ctx.fill();
                en.x += (player.x - en.x) * 0.01; en.y += (player.y - en.y) * 0.01;
            });

            // Ø§Ù„Ø±ØµØ§Øµ ÙˆØªØ¯Ù…ÙŠØ± Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
            bullets.forEach((b, bi) => {
                b.x += b.vx; b.y += b.vy;
                ctx.fillStyle = b.color; ctx.beginPath(); ctx.arc(b.x, b.y, b.isSuper ? 15 : 5, 0, Math.PI*2); ctx.fill();
                enemies.forEach((en, ei) => {
                    if(Math.hypot(b.x-en.x, b.y-en.y) < 30) {
                        en.hp -= b.isSuper ? 100 : 34;
                        bullets.splice(bi, 1);
                        if(en.hp <= 0) { 
                            enemies.splice(ei, 1); 
                            player.superCharge += 40;
                            if(player.superCharge >= 100) document.getElementById('super-btn').style.display = 'flex';
                        }
                    }
                });
            });

            requestAnimationFrame(draw);
        }
        draw();
    </script>
</body>
</html>
